---
---
<div class="hla-diagram">
  <!-- Layer 1: Presentation -->
  <div class="hla-layer hla-presentation">
    <div class="hla-layer-header">
      <span class="hla-badge hla-badge-green">1</span>
      <span class="hla-layer-title">Presentation Layer</span>
    </div>
    <div class="hla-nodes hla-cols-3">
      <div class="hla-node hla-node-green">
        <span class="hla-icon">üåê</span>
        <span class="hla-name">Web Dashboard</span>
        <span class="hla-tech">SvelteKit</span>
      </div>
      <div class="hla-node hla-node-green">
        <span class="hla-icon">‚ö°</span>
        <span class="hla-name">REST API</span>
        <span class="hla-tech">FastAPI</span>
      </div>
      <div class="hla-node hla-node-green">
        <span class="hla-icon">üíª</span>
        <span class="hla-name">CLI</span>
        <span class="hla-tech">Typer + Rich</span>
      </div>
    </div>
  </div>

  <!-- Connector -->
  <div class="hla-connector">
    <svg width="100%" height="24" viewBox="0 0 400 24" preserveAspectRatio="none">
      <line x1="200" y1="0" x2="200" y2="24" stroke="var(--sl-color-gray-4)" stroke-width="2"/>
      <polygon points="194,16 206,16 200,24" fill="var(--sl-color-accent)"/>
    </svg>
  </div>

  <!-- Layer 2: Business Logic -->
  <div class="hla-layer hla-business">
    <div class="hla-layer-header">
      <span class="hla-badge hla-badge-blue">2</span>
      <span class="hla-layer-title">Business Logic</span>
      <span class="hla-layer-tag">Infrastructure-independent</span>
    </div>
    <div class="hla-nodes hla-cols-3">
      <div class="hla-node hla-node-blue">
        <span class="hla-icon">üîÑ</span>
        <span class="hla-name">DataProcessor</span>
        <span class="hla-tech">Orchestrator</span>
      </div>
      <div class="hla-node hla-node-blue">
        <span class="hla-icon">üßÆ</span>
        <span class="hla-name">Carbon Calculator</span>
        <span class="hla-tech">CO‚ÇÇe computation</span>
      </div>
      <div class="hla-node hla-node-blue">
        <span class="hla-icon">üìä</span>
        <span class="hla-name">Recommender</span>
        <span class="hla-tech">Analysis engine</span>
      </div>
    </div>
    <div class="hla-nodes hla-nodes-secondary hla-cols-2">
      <div class="hla-node hla-node-blue-light">
        <span class="hla-icon">‚ö°</span>
        <span class="hla-name">BasicEstimator</span>
        <span class="hla-tech">Energy model</span>
      </div>
      <div class="hla-node hla-node-blue-light">
        <span class="hla-icon">üîß</span>
        <span class="hla-name">Config</span>
        <span class="hla-tech">12-Factor</span>
      </div>
    </div>
  </div>

  <!-- Connector -->
  <div class="hla-connector">
    <svg width="100%" height="24" viewBox="0 0 400 24" preserveAspectRatio="none">
      <line x1="200" y1="0" x2="200" y2="24" stroke="var(--sl-color-gray-4)" stroke-width="2"/>
      <polygon points="194,16 206,16 200,24" fill="var(--sl-color-accent)"/>
    </svg>
  </div>

  <!-- Layer 3: Adapters -->
  <div class="hla-layer hla-adapters">
    <div class="hla-layer-header">
      <span class="hla-badge hla-badge-purple">3</span>
      <span class="hla-layer-title">Adapters (I/O)</span>
    </div>
    <div class="hla-adapters-split">
      <!-- Input Adapters -->
      <div class="hla-adapter-group hla-input">
        <div class="hla-group-label">
          <span class="hla-arrow-in">‚Üí</span> Input (Collectors)
        </div>
        <div class="hla-adapter-list">
          <div class="hla-adapter">
            <span class="hla-dot hla-dot-orange"></span>PrometheusCollector
          </div>
          <div class="hla-adapter">
            <span class="hla-dot hla-dot-orange"></span>NodeCollector
          </div>
          <div class="hla-adapter">
            <span class="hla-dot hla-dot-orange"></span>PodCollector
          </div>
          <div class="hla-adapter">
            <span class="hla-dot hla-dot-orange"></span>HPACollector
          </div>
          <div class="hla-adapter">
            <span class="hla-dot hla-dot-orange"></span>OpenCostCollector
          </div>
          <div class="hla-adapter">
            <span class="hla-dot hla-dot-orange"></span>ElectricityMapsCollector
          </div>
          <div class="hla-adapter">
            <span class="hla-dot hla-dot-orange"></span>BoaviztaCollector
          </div>
        </div>
      </div>
      <!-- Output Adapters -->
      <div class="hla-adapter-group hla-output">
        <div class="hla-group-label">
          Output (Repositories) <span class="hla-arrow-out">‚Üí</span>
        </div>
        <div class="hla-adapter-list">
          <div class="hla-adapter">
            <span class="hla-dot hla-dot-cyan"></span>PostgresRepository
          </div>
          <div class="hla-adapter">
            <span class="hla-dot hla-dot-cyan"></span>SQLiteRepository
          </div>
          <div class="hla-adapter">
            <span class="hla-dot hla-dot-cyan"></span>ElasticsearchRepo
          </div>
          <div class="hla-adapter">
            <span class="hla-dot hla-dot-cyan"></span>NodeRepository
          </div>
          <div class="hla-adapter">
            <span class="hla-dot hla-dot-cyan"></span>RecommendationRepo
          </div>
          <div class="hla-adapter">
            <span class="hla-dot hla-dot-cyan"></span>EmbodiedRepository
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .hla-diagram {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0;
    margin: 2rem 0;
    font-family: system-ui, -apple-system, sans-serif;
  }

  .hla-layer {
    width: 100%;
    border: 1px solid var(--sl-color-gray-5);
    border-radius: 0.75rem;
    overflow: hidden;
    background: var(--sl-color-gray-6);
  }

  .hla-layer-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.6rem 1rem;
    border-bottom: 1px solid var(--sl-color-gray-5);
    background: rgba(255,255,255,0.02);
  }

  .hla-badge {
    width: 1.3rem;
    height: 1.3rem;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.65rem;
    font-weight: 700;
    color: #fff;
    flex-shrink: 0;
  }
  .hla-badge-green { background: #16a34a; }
  .hla-badge-blue { background: #2563eb; }
  .hla-badge-purple { background: #7c3aed; }

  .hla-layer-title {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.04em;
    color: var(--sl-color-white);
  }

  .hla-layer-tag {
    font-size: 0.55rem;
    background: rgba(59, 130, 246, 0.15);
    color: #60a5fa;
    padding: 0.15rem 0.45rem;
    border-radius: 9999px;
    font-weight: 600;
    margin-left: auto;
  }

  .hla-nodes {
    display: grid;
    gap: 0.75rem;
    padding: 1rem;
  }

  .hla-cols-2 { grid-template-columns: repeat(2, 1fr); max-width: 66%; margin-left: auto; margin-right: auto; }
  .hla-cols-3 { grid-template-columns: repeat(3, 1fr); }

  .hla-nodes-secondary {
    padding-top: 0;
  }

  .hla-node {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 0.6rem 1rem;
    border-radius: 0.5rem;
    border: 1px solid var(--sl-color-gray-5);
    transition: border-color 0.2s, transform 0.15s;
  }
  .hla-node:hover { transform: translateY(-2px); }

  .hla-node-green { background: rgba(34, 197, 94, 0.06); border-color: rgba(34, 197, 94, 0.25); }
  .hla-node-green:hover { border-color: rgba(34, 197, 94, 0.5); }
  .hla-node-blue { background: rgba(59, 130, 246, 0.06); border-color: rgba(59, 130, 246, 0.25); }
  .hla-node-blue:hover { border-color: rgba(59, 130, 246, 0.5); }
  .hla-node-blue-light { background: rgba(59, 130, 246, 0.03); border-color: rgba(59, 130, 246, 0.15); }
  .hla-node-blue-light:hover { border-color: rgba(59, 130, 246, 0.4); }

  .hla-icon { font-size: 1.1rem; margin-bottom: 0.2rem; }
  .hla-name { font-size: 0.72rem; font-weight: 700; color: var(--sl-color-white); }
  .hla-tech { font-size: 0.6rem; color: var(--sl-color-gray-3); margin-top: 0.1rem; }

  .hla-connector {
    width: 100%;
    display: flex;
    justify-content: center;
    height: 24px;
  }

  .hla-adapters-split {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0.75rem;
    padding: 1rem;
  }

  .hla-adapter-group {
    border: 1px solid var(--sl-color-gray-5);
    border-radius: 0.5rem;
    overflow: hidden;
  }

  .hla-group-label {
    padding: 0.4rem 0.75rem;
    font-size: 0.65rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.03em;
    color: var(--sl-color-gray-3);
    border-bottom: 1px solid var(--sl-color-gray-5);
    background: rgba(255,255,255,0.02);
  }

  .hla-arrow-in { color: #f97316; }
  .hla-arrow-out { color: #06b6d4; }

  .hla-adapter-list {
    padding: 0.5rem 0.75rem;
    display: flex;
    flex-direction: column;
    gap: 0.35rem;
  }

  .hla-adapter {
    display: flex;
    align-items: center;
    gap: 0.4rem;
    font-size: 0.65rem;
    color: var(--sl-color-gray-2);
    font-family: ui-monospace, 'SF Mono', 'Cascadia Mono', monospace;
  }

  .hla-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    flex-shrink: 0;
  }
  .hla-dot-orange { background: #f97316; }
  .hla-dot-cyan { background: #06b6d4; }

  @media (max-width: 640px) {
    .hla-adapters-split {
      grid-template-columns: 1fr;
    }
    .hla-cols-3 {
      grid-template-columns: repeat(2, 1fr);
    }
    .hla-cols-2 {
      grid-template-columns: repeat(2, 1fr);
      max-width: 100%;
    }
    .hla-nodes {
      gap: 0.5rem;
    }
  }
</style>
